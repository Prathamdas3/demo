---
name: blogTestSuite
description: Tests for verifying the blog resource policy
tests:
  - name: blog actions
    input:
      principals:
        - user#1
        - admin#2
        - user1#3
        - user2#4
        - user3#5
        - user4#6
      resources:
        - blog#1
      actions:
        - create
        - read
        - update
        - delete
    expected:
      - resource: blog#1
        principal: user#1
        actions:
          create: EFFECT_ALLOW
          read: EFFECT_ALLOW
          update: EFFECT_ALLOW
          delete: EFFECT_DENY
      - resource: blog#1
        principal: admin#2
        actions:
          create: EFFECT_ALLOW
          read: EFFECT_ALLOW
          update: EFFECT_ALLOW
          delete: EFFECT_ALLOW
      - resource: blog#1
        principal: user1#3
        actions:
          create: EFFECT_DENY
          read: EFFECT_ALLOW
          update: EFFECT_DENY
          delete: EFFECT_DENY
      - resource: blog#1
        principal: user2#4
        actions:
          create: EFFECT_DENY
          read: EFFECT_ALLOW
          update: EFFECT_DENY
          delete: EFFECT_DENY
      - resource: blog#1
        principal: user3#5
        actions:
          create: EFFECT_DENY
          read: EFFECT_ALLOW
          update: EFFECT_DENY
          delete: EFFECT_DENY
      - resource: blog#1
        principal: user4#6
        actions:
          create: EFFECT_DENY
          read: EFFECT_ALLOW
          update: EFFECT_DENY
          delete: EFFECT_DENY
